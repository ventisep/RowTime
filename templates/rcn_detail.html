
{% extends "templates/layout.html" %}
{% block main %}
 <!--Add a button for the user to click to initiate auth sequence -->
    <button id="get_list">get time list</button>
    <script type="text/javascript">

	  function init() {
	    var ROWTIME_API = 'https://rowtime-26.appspot.com/_ah/api';
		gapi.client.load('observedtimes', 'v1', function() {api_loading_init();}, ROWTIME_API);
	  }

	  function api_loading_init() {
		alert("ROWTIME_API loaded and init function called");
	  }

			// Insert an observed time
	  function record_observed_time(observed_time) {
		var request = gapi.client.observedtimes.times.timecreate.post(observed_time).execute(function(resp) {
	  	console.log(resp);
	  	}
	  });

      // Load the API and make an API call.  Display the results on the screen.
      function makeApiCall() {

        var request = gapi.client.observedtimes.times.listtimes.get({
            'seq':0
        });
          // Step 6: Execute the API request
        request.then(function(resp) {

          	t = document.createTextNode(resp);
            document.getElementById('content').appendChild(t);
        }, function(reason) {
            console.log('Error: ' + reason.result.error.message);
          });
       });
    </script>
    // Step 1: Load JavaScript client library
    <script src="https://apis.google.com/js/client.js?onload=init"></script>






<script type="text/javascript">

// Get the list of previous scores
gapi.client.tictactoe.scores.list().execute(function(resp) {
  console.log(resp);
});
	}
    function test_func() { 	//this function is run onload and paints the screen with the 

								//crews and their times
        var data={{ data|safe }}; //get data passed from jinja2
        var crew_data = []			//create and array to hold the crew data

        for (i=0; i < data.length; i++) {   //step through the data passed and assign it to crew_data
        	crew_data[i]=JSON.parse(data[i]); //convert the JSON string to an object
        

 	       	var btn = document.createElement("BUTTON");        // Create a <button> element
			var t = document.createTextNode(crew_data[i].crew_number.toString());       // Create a text node
			btn.appendChild(t);                                // Append the text to <button>
			document.body.appendChild(btn);                    // Append <button> to <body>
		}	

    }
</script>
<body onload="myFunction(); test_func();" id="body">
	<script>
		function myFunction() {
			var rand_num = Math.floor((Math.random() * 10) + 1);
			background = "url('/images/rowingpic" + String(rand_num) + ".jpg')";
			document.body.style.backgroundImage = background;
		}
		function Start_Crew(){
			var start_time = "TIME HERE"; //start time fetch from back end here
			var start_time_textElement = document.getElementById("start_(crew-num)");
			start_time_textElement.style.color = "green";
			start_time_textElement.value = start_time;
			var button = document.getElementById("start");
			button.value = "Stop";
			button.style.color = "red";
			button.id = "stop";
		}
		function Stop_Crew(){
			try{
				var button = document.getElementById("stop");
				button.value = "Finished"
				button.style.color = "";
				button.disabled = true;
				var stop_time = "TIME HERE"; //stop time fetch from back end here
				var stop_time_textElement = document.getElementById("stop_(crew-num)");
				stop_time_textElement.value = stop_time;
				stop_time_textElement.style.color = "red";
			}
			catch(err){
			}
		}
	</script>

  <header>
    <h2>{{event.event_name}} timing</h2>
  </header>
  <span id="username">{{user.name}}</span><br><br>

<table border="0" style="padding-top: 20px;">
	<tr style="outline: thin solid">
		<td style="border-right-width: 1px; border-right-style: solid;">Crew No.</td>
		<td style="border-right-width: 1px; border-right-style: solid;">Crew Name</td>
		<td>Start</td>
		<td>Stop</td>
	</tr>
{% for crew in crews %}
	<tr>
		<td style="border-right-width: 1px; border-right-style: solid;">{{crew.crew_number}}</td>
		<td style="border-right-width: 1px; border-right-style: solid;">{{crew.crew_type}}</td>
		<td><input id="start_(crew-num)" type="datetime" placeholder="Start"/></td>
		<td><input id="stop_(crew-num)" type="text" placeholder="Stop"/></td>
		<td><input type="button" value="start" id="start" onClick="Stop_Crew(); Start_Crew();"/></td>
	</tr>
{% endfor %}
</table><br>
</body>
{% endblock %}
